# Copyright (C) 2025 Southern California Edison.
# SPDX-License-Identifier: Apache-2.0

name: CI Conformance

on: [push]

jobs:
    shellcheck:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v4
            - name: Run static test
              uses: ludeeus/action-shellcheck@2.0.0
              env:
                  SHELLCHECK_OPTS: -xo all launch_conformance_tests.sh src/launch_conformance_tests_ssh.sh
    pylint:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v4
            - name: Install python
              uses: actions/setup-python@v4
              with:
                  python-version: '3.12'
            - name: Install pylint and dependencies
              run: |
                  python -m pip install --upgrade pip
                  pip install pylint pexpect pyserial
            - name: Run pylint
              run: |
                  pylint src/launch_conformance_tests_serial.py
    on-target-tests-ssh-imx93:
        uses: ./.github/workflows/ci-conformance-on-target-ssh.yml
        with:
            runner: imx93
        secrets:
            target_ip: ${{ secrets.IMX93_TARGET_IP }}
            target_password: ${{ secrets.IMX93_TARGET_PASSWORD }}
        needs: [shellcheck, pylint]
